@using System.Security.Claims
@using Microsoft.AspNetCore.Mvc.TagHelpers
@model ArticleModel

<div class="card">
    <div class="card-body">
        <h3 class="card-title">@Model.Title</h3>
        <p class="card-text">@Html.Raw(Model.Description)</p>
        @if (!string.IsNullOrEmpty(Model.UrlToImage))
        {
            <img src="@Model.UrlToImage" alt="Article Image" class="article-image"/>
        }
        <a asp-controller="Article" asp-action="Details" asp-route-id="@Model.Id" class="btn btn-primary">More Detail</a>
        @if ((bool?)ViewData["IsAdmin"] == true)
        {

            @using (Html.BeginForm("DeleteArticle", "Article", new { id = Model.Id }, FormMethod.Post))
            {
                @Html.AntiForgeryToken()
                <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this article?');">Delete</button>
            }
        }
        @if (User.Identity.IsAuthenticated)
        {
            <!-- Like and Unlike buttons -->
            var likeModel = new LikeModel{ ArticleId = Model.Id , UserId = Guid.Parse(User.FindFirstValue(ClaimTypes.NameIdentifier))};
            @Html.Partial("_LikeButton", likeModel)
            @Html.Partial("_UnlikeButton", likeModel)
           
          
        }
        <span>@Model.LikesCount Likes</span>
        
        
        @if (User.Identity.IsAuthenticated)
        {
            <form asp-action="ToggleBookmark" asp-controller="Bookmark" asp-route-articleId="@Model.Id" method="post">
                <button type="submit" class="btn @(Model.IsBookmarked ? "btn-info" : "btn-outline-info")">
                    <i class="@(Model.IsBookmarked ? "fas" : "far") fa-bookmark"></i> @(Model.IsBookmarked ? "Unbookmark" : "Bookmark")
                </button>
                    
            </form>
        }
        
        
        
    </div>
</div>

